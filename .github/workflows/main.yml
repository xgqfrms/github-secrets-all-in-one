# This is a basic workflow to help you get started with Actions

# workflow name
name: ğŸš€ DevOps ğŸ‘» CI/CD

# workflow è§¦å‘äº‹ä»¶, æ§åˆ¶ action ä½•æ—¶è¿è¡Œ
# åœ¨ push æˆ– pull è¯·æ±‚æ—¶è§¦å‘å·¥ä½œæµç¨‹äº‹ä»¶ï¼Œä½†ä»…é’ˆå¯¹ master & main åˆ†æ”¯
on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]

# ä¸€ä¸ª workflow è¿è¡Œç”±å¯ä»¥ä¸²è¡Œæˆ–å¹¶è¡Œè¿è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ª jobs ç»„æˆ
jobs:
  # æ­¤å·¥ä½œæµç¨‹ä»…åŒ…å«ä¸€ä¸ªåä¸º "build_job" çš„ job
  build_job:
    # job å°†è¿è¡Œçš„ runner ç±»å‹(æ‰§è¡Œçš„ç³»ç»Ÿç¯å¢ƒ Linux ğŸ‘/ macOS ğŸš€/ Windows ğŸ‘)
    runs-on: ubuntu-latest
    
    # ä¸€ä¸ª job å¯ä»¥åŒ…å«å¤šä¸ª steps
    # æ­¥éª¤è¡¨ç¤ºå°†ä½œä¸º job ä¸€éƒ¨åˆ†æ‰§è¡Œçš„ä¸€ç³»åˆ— tasks
    steps:
      # åœ¨ $GITHUB_WORKSPACE ä¸‹æ£€å‡ºä½ çš„ repositoryï¼Œä»¥ä¾¿ä½ çš„ job å¯ä»¥è®¿é—®å®ƒ
      # uses ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ actions
      - uses: actions/checkout@v2
      
      # uses ä½¿ç”¨ç¬¬ä¸€æ–¹çš„ actionsï¼Œè‡ªå®šä¹‰çš„ actions
      - uses: ./actions
        with:
          MY_NAME: "xgqfrms"
          TOKEN: "$ACCESS_TOKEN"
      
      # with & env
      - name: access_token action
        with: # Set the secret as an input
          access_token: ${{ secrets.ACCESS_TOKEN }}
        env: # Or as an environment variable
          access_token: ${{ secrets.ACCESS_TOKEN }}

      # ä½¿ç”¨ runners shell è¿è¡Œå•ä¸ªå‘½ä»¤ 
      - name: Run a one-line script âœ… ğŸ‘¨ğŸ»â€ğŸ’»
        run: echo æ­£åœ¨æ‰§è¡Œå•ä¸ªå‘½ä»¤! 

      # ä½¿ç”¨ runners shell è¿è¡Œä¸€ç»„å‘½ä»¤
      - name: Run a multi-line script âœ… ğŸ‘¨ğŸ»â€ğŸ’»
        run: |
          echo æ­£åœ¨æ‰§è¡Œå¤šä¸ªå‘½ä»¤çš„ lint
          echo æ­£åœ¨æ‰§è¡Œå¤šä¸ªå‘½ä»¤çš„ test
          echo æ­£åœ¨æ‰§è¡Œå¤šä¸ªå‘½ä»¤çš„ build
          echo æ­£åœ¨æ‰§è¡Œå¤šä¸ªå‘½ä»¤çš„ deploy
          echo æ­£åœ¨æ‰§è¡Œå¤šä¸ªå‘½ä»¤çš„ npm publish
          echo finished ğŸ‰
